<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
    To suppress generation of this file remove `set ide=true` from the PostBuildEvent of the VS project
</auto-generated>
-->
  <Package Compressed="yes" ProductCode="5939155f-c7e1-43ee-aad9-9bc68a8529c5" Name="Bean Mod Manager" Language="1033" Version="1.5.4" UpgradeCode="5939155f-c7e1-43ee-aad9-9bc67a35d9c5" Manufacturer="rewalo" Scope="perMachine" InstallerVersion="200">
    <SummaryInformation Codepage="Windows-1252" />
    <Media Id="1" Cabinet="Bean20Mod20Manager.cab" EmbedCab="yes" />

    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLDIR" Name="Bean Mod Manager">

        <Component Id="Component.BeanModManager.exe_1943252492" Guid="5939155f-c7e1-43ee-aad9-9bc6ba8f3ca5">
          <File Id="BeanModManager.exe_1943252492" Source="..\bin\Release\BeanModManager.exe" />
        </Component>

      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="DesktopFolder">

      <Component Id="Component.Bean20Mod20Manager__" Guid="5939155f-c7e1-43ee-aad9-9bc6a389d8a6" Condition="DESKTOP_SHORTCUT=&quot;1&quot;">
        <Shortcut Id="DesktopFolder.Bean20Mod20Manager__" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]BeanModManager.exe" Name="Bean Mod Manager.lnk" />

        <CreateFolder />

        <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
          <RegistryValue Value="0" Type="string" KeyPath="yes" />
        </RegistryKey>
      </Component>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="Bean20Mod20Manager.1" Name="Bean Mod Manager">

        <Component Id="Component.Bean20Mod20Manager.1_" Guid="5939155f-c7e1-43ee-aad9-9bc67a3b61a8" Condition="START_MENU_ENTRY=&quot;1&quot;">
          <Shortcut Id="Bean20Mod20Manager.1.Bean20Mod20Manager.1_" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]BeanModManager.exe" Name="Bean Mod Manager.lnk" />

          <CreateFolder />
          <RemoveFolder Id="Bean20Mod20Manager.1" On="uninstall" />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

        <Component Id="Component.Uninstall20Bean20Mod20Manager" Guid="5939155f-c7e1-43ee-aad9-9bc6f865d3db" Condition="START_MENU_ENTRY=&quot;1&quot;">
          <Shortcut Id="Bean20Mod20Manager.1.Uninstall20Bean20Mod20Manager" WorkingDirectory="System64Folder" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" Name="Uninstall Bean Mod Manager.lnk" />

          <CreateFolder />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

      </Directory>
    </StandardDirectory>

    <UI />

    <Icon Id="app_icon.ico" SourceFile="..\mod.ico" />

    <WixUI Id="WixUI_Minimal" xmlns="http://wixtoolset.org/schemas/v4/wxs/ui" />

    <UI>
      <EmbeddedUI Id="WixSharp_EmbeddedUI_Asm" SourceFile="WixSharp.UI.CA.dll" />
    </UI>

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_CancelRequestHandler_Props" Property="CancelRequestHandler" Value="UpgradeCode=[UpgradeCode];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="CancelRequestHandler" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="CancelRequestHandler" Return="check" Impersonate="no" Execute="deferred" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="WixSharp.CA.dll" />
    <Binary Id="WixSharp_UIText" SourceFile="..\..\..\..\..\..\ProgramData\WixSharp\2.10.0.0\WixUI_en-US.wxl" />
    <Binary Id="WixSharp_LicenceFile" SourceFile="Bean Mod Manager.licence.rtf" />
    <Binary Id="WixSharpUI_Bmp_Dialog" SourceFile="Bean Mod Manager.dialog_bmp.png" />
    <Binary Id="WixSharpUI_Bmp_Banner" SourceFile="Bean Mod Manager.dialog_banner.png" />

    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="DESKTOP_SHORTCUT" Value="1" />
    <Property Id="START_MENU_ENTRY" Value="1" />
    <Property Id="WixSharp_UI_INSTALLDIR" Value="INSTALLDIR" />
    <Property Id="UAC_WARNING" Value="Please wait for UAC prompt to appear.&#xD;&#xA;&#xD;&#xA;If it appears minimized then activate it from the taskbar." />
    <Property Id="WixSharp_InstallDialogs" Value="Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.WelcomeDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.LicenceDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.InstallDirDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.OptionsDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.ProgressDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.ExitDialog" />
    <Property Id="WixSharp_ModifyDialogs" Value="Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.MaintenanceTypeDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.ProgressDialog&#xA;Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Setup.Dialogs.ExitDialog" />
    <Property Id="ARPCOMMENTS" Value="A simple mod manager for Among Us. Install and manage mods like TOHE, Town of Us Mira, Better CrewLink, and The Other Roles without the hassle." />
    <Property Id="ARPHELPLINK" Value="https://github.com/rewalo/BeanModManager" />
    <Property Id="ARPPRODUCTICON" Value="app_icon.ico" />
    <Property Id="ARPREADME" Value="https://github.com/rewalo/BeanModManager/blob/master/README.md" />
    <Property Id="ARPURLINFOABOUT" Value="https://github.com/rewalo/BeanModManager" />
    <Property Id="ARPURLUPDATEINFO" Value="https://github.com/rewalo/BeanModManager/releases" />

    <Feature Id="Complete" Title="Complete" Level="1" AllowAbsent="yes">
      <ComponentRef Id="Component.BeanModManager.exe_1943252492" />
      <ComponentRef Id="Component.Bean20Mod20Manager__" />
      <ComponentRef Id="Component.Bean20Mod20Manager.1_" />
      <ComponentRef Id="Component.Uninstall20Bean20Mod20Manager" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Condition=" (1) " Action="WixSharp_InitRuntime_Action" Before="AppSearch" />
      <Custom Action="Set_CancelRequestHandler_Props" Before="InstallFinalize" />
      <Custom Condition=" (1) " Action="CancelRequestHandler" After="Set_CancelRequestHandler_Props" />
    </InstallExecuteSequence>
  </Package>
</Wix>

